SmartArray: Enhanced Arrays with Automatic HTML Encoding and Chainable Methods
==========================================================================================
SmartArray extends PHP arrays with automatic HTML encoding and chainable utility methods.
It adds powerful features for filtering, mapping, and data manipulation - making common
array operations simpler, safer, and more expressive.

Core Concepts
-------------------
$obj              = Itools\SmartArray\SmartArray    // Arrays become SmartArray objects (even nested arrays)
$obj->columnName  = Itools\SmartString\SmartString  // Values become SmartString objects with HTML-encoded output

Accessing Elements
-------------------
foreach ($users as $user) {          // Foreach over a SmartArray just like a regular array
    echo "Name: $user->name\n";      // SmartString output is automatically HTML-encoded, no need for htmlspecialchars()

    // For more complex expressions, curly braces are still required
    echo "Bio: {$user->bio->textOnly()->maxChars(120, '...')}\n";  // Chain SmartString methods on column values
}

Original Values
-------------------
$obj->toArray()                      // Get original array with raw values
$obj->columnName->value()            // Get original unencoded field value
"Bio: {$user->wysiwyg->rawHtml()}"   // Alias for value(), clearer when handling trusted WYSIWYG/HTML content

Creating SmartArrays
-------------------
$data  = SmartArray::new([1, 2, 3]);                        // Raw PHP values for data processing
$users = SmartArray::new(DB::select('users'));              // Always start with raw data

Converting Between Types:
$array = $data->toArray();                                  // Converts back to regular PHP array with original values
$html  = $data->asHtml();                                   // Return values as HTML-safe SmartStrings when needed
$raw   = $html->asRaw();                                    // Return values as raw PHP types
$html  = SmartArrayHtml::new($data);                        // Create HTML-safe SmartArray directly (same result)

Example Workflow:
$users = SmartArray::new($records)                           // Raw data for processing
    ->filter(fn($u) => $u['active'])                         // Work with raw values
    ->sortBy('name');                                        // Chain operations efficiently

// Convert to HTML-safe only when outputting to templates
foreach ($users->asHtml() as $user) {
    echo "Name: $user->name\n";                              // Automatically HTML-encoded
}

Value Access
-------------
$obj->key               Get a value using property syntax
->get(key)              Get a value by key (for numeric keys or keys with special characters)
->get(key, default)     Get a value with optional default if key not found
->set(key, value)       Set a value by key (for numeric keys or keys with special characters)
->first()               Get the first element
->last()                Get the last element
->nth(position)         Get element by position, ignoring keys (0 is first, -1 is last)
SmartArray::getRawValue($value)  Convert Smart* objects to original values, leave other types unchanged

Array Information
------------------
->count()               Get the number of elements
->isEmpty()             Returns true if array has no elements
->isNotEmpty()          Returns true if array has any elements
->contains(value)       Check if array contains a specific value

Sorting & Filtering
--------------------
->sort()                Sort elements by value, reindexing keys
->sortBy(column)        Sort nested array by column value, reindexing keys
->unique()              Remove duplicate values, keeping first occurrence
->filter(callback)      Keep elements where callback returns true, using raw values
->where(conditions)     Keep elements matching [column => value] conditions (uses == for type-tolerant matching)
->where(field, value)   Shorthand: Keep elements where field matches value

Array Transformation
---------------------
->toArray()             Convert SmartArray/SmartString structure back to array/values
->keys()                Get array of just the keys
->values()              Get array of just the values
->indexBy(column)       Get array using column as keys to single rows (duplicates overwrite)
->groupBy(column)       Get array using column as keys to arrays of rows (duplicates group)
->pluck(column)         Extract single column from nested array
->pluckNth(position)    Get array containing nth element from each row
->implode(separator)    Join elements with separator into string (default: '')
->sprintf(format)       Apply sprintf format to each element. Also supports {value} and {key} aliases.
->map(callback)         Transform each element using callback (callback receives raw values)
->each($callback)       Call callback on each element as Smart objects.  Used for side effects, doesn't modify array.
->merge(...$arrays)     Merges with one or more arrays. Numeric keys are renumbered, string keys are overwritten by later values.

Database Operations
--------------------
->mysqli()              Get an array of all mysqli result metadata (set when creating array from DB result)
->mysqli(key)           Get specific mysqli result metadata (affected_rows, insert_id, etc)
->load()                Loads related record(s) if available for column

Error Handling
---------------
->or404(message)        Returns 404 with message if array is empty (default message: "404 Not Found")
->orDie(message)        Exits with message if array is empty
->orThrow(exception)    Throws exception if array is empty
->orRedirect(url)       Redirects to URL if array is empty (HTTP 302 redirect)

Debugging
----------
print_r($obj)           Show array values
$obj->debug()           Show array values, mysqli metadata, and available load() handlers
$obj->help()            Display this help information

For more details see SmartArray readme.md, and SmartString docs for chainable string methods.
